<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <!-- 제목 -->
        <title>アニメーションイベントとスクリプト</title>
        <!-- 파비콘 -->
        <link rel="shortcut icon" href="../../Images/favicon.ico"/>
        <!-- 부트스트랩 -->
        <link rel="stylesheet" href="../../css/bootstrap.css">
        <!--------------->

    </head>

    <body>
        <p>
            <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark">
            <!--로고 : AnyPortrait 홈페이지로 가야한다. (언어별)-->
            <a class="navbar-brand" href="https://www.rainyrizzle.com/anyportrait-jp">
                <img src="../../Images/AP_Logo.png" width="150" height="30" class="d-inline-block align-top" alt="">
            </a>

            <!--메뉴들 : 현재 페이지의 카테고리에 active 붙인다. (언어별 링크) -->
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarText">
                <ul class="navbar-nav mr-auto">
                <li class="nav-item">
                    <a class="nav-link" href="../../jp/GettingStarted.html">入門ガイド</a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="../../jp/AdManual.html">マニュアル</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../jp/Script.html">スクリプト</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://www.rainyrizzle.com/ap-videotutorial-jp">ビデオ</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://www.rainyrizzle.com/ap-forum">フォーラム</a>
                </li>

                </ul>

                <!-- 언어 변경. 현재 페이지의 주소에서 언어 주소만 변경한다. (해당 언어에 active) -->
                <div class="btn-group mr-2" role="group" aria-label="Basic example">
                    <a role="button" class="btn btn-secondary" href="../../en/AdvancedManual/AD_AnimationEvents.html">EN</a>
                    <a role="button" class="btn btn-secondary" href="../../kr/AdvancedManual/AD_AnimationEvents.html">KR</a>
                    <a role="button" class="btn btn-secondary active" href="../../jp/AdvancedManual/AD_AnimationEvents.html">JP</a>
                </div>

                <!-- 여백 -->
                <p></p>

                <!-- 검색버튼 -->
                <form class="form-inline">
                    <a class="btn btn-light" role="button" href="../../jp/Search.html">サーチ</a>
                </form>
            </div>
        </nav>
    </p>

    <!-- 실제 바디 부분 -->
    <div class="container">
    <br>
    <br>
    <!-- 여기에 내용을 적어주세요 -->

    <!-- 여기서부터 페이지 내용이 작성됩니다. -->
    <!-- 1. 페이지 진입 경로 -->
    <p><a href="https://www.rainyrizzle.com/anyportrait-jp"><span class="text-dark">AnyPortrait</span></a> > <a href="../../jp/AdManual.html"><span class="text-dark">マニュアル</span></a> > アニメーションイベントとスクリプト</p>
    
    <!-- 2. 페이지 메인 타이틀 -->
    <h1 class="display-5">アニメーションイベントとスクリプト</h1>
    <br>
    
    <!-- 4. 버전 설명 -->
    <h4><span class="badge badge-secondary">1.4.5</span></h4>
    
    <p>
    ゲームに応じて、アニメーションのある時点で、キャラクターは何らかの相互作用を必要とします。<br>
    走るキャラクターがジャンプをしたときに土ぼこりが発生したり、キャラクターが振るう剣がモンスターを殴ることもできます。<br>
    このページでは、「<strong>アニメーションイベント (Animation Event)</strong>」関数を使用して、スクリプトと対話する方法を学習します。<br>
    (C＃スクリプトを含む。)<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_122.jpg"/>
    <br>
    
    <p>
    アニメーションのプロパティUIで、「<strong>Animation Events」</strong>ボタンをクリックして、アニメーションイベントを登録するダイアログを開きます。<br>
    </p>
    <br>
    
    <!-- 12. 참고 박스 시작 -->
    <div class="alert alert-info" role="alert">
    
    <p>
    「AnyPortrait v1.4.0」で変更されたアニメーションイベントダイアログの説明は、ページ下部にあります。<br>
    </p>
    <br>
    
    </div>
    <br>
    <br>
    
    <br>
    <br>
    <!-- 3. 서브 타이틀 -->
    <h3>アニメーションイベントを追加し、それらをスクリプトに関連付け</h3>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_123.jpg"/>
    <br>
    
    <p>
    <strong>(1)</strong> <strong>「Add Event」ボタン</strong>をクリックして新しいイベントを追加します。<br>
    <strong>(2)</strong> <strong>イベント名を設定し</strong>、呼び出すフレームを入力します。<br>
    イベントの名前はスクリプトとリンクされているので、その時の名前を覚えておいてください。<br>
    私はここで 「<span class="text-danger"><strong>SampleAnimEvent</strong></span>」として作成しました。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_124.jpg"/>
    <br>
    
    <p>
    アニメーションイベントが追加されると、タイムラインGUIに「<strong>イベントマーカー (Event Marker)</strong>」が追加されたことがわかります。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_125.jpg"/>
    <br>
    
    <p>
    「Bake」とシーンを開きます。<br>
    イベントに関連付けるスクリプトを作成します。<br>
    <strong>(1)</strong> スクリプトを格納する「<strong>GameObject</strong>」を作成します。 (それは新しいものである必要はなく、スクリプトを含む 「GameObject」のどれかでもかまいません。)<br>
    <strong>(2)</strong> <strong>「MonoBehaviour」</strong>スクリプトを作成して追加します。<br>
    </p>
    <br>
    
    <p>
    次のコードを記述します：<br>
    上で作成したアニメーションイベントの名前は「<span class="text-danger"><strong>SampleAnimEvent</strong></span>」です。<br>
    </p>
    <br>
    
    <!-- 23. 코드 예시 -->
    <div class="alert alert-warning" role="alert">
    <p>
    <br>
    <span class="text-primary">using </span>UnityEngine;<br>
    <span class="text-primary">public class </span><span class="text-success">AnimEventListener</span> : <span class="text-success">MonoBehaviour</span><br>
    {<br>
    &emsp;&emsp;<span class="text-primary">void</span> Start() { }<br>
    &emsp;&emsp;<span class="text-primary">void</span> SampleAnimEvent()<br>
    &emsp;&emsp;{<br>
    &emsp;&emsp;&emsp;&emsp;<span class="text-success">Debug</span>.Log(<span class="text-danger">"Sample Anim Event"</span>);<br>
    &emsp;&emsp;}<br>
    }<br>
    <br>
    </p>
    <button id="scriptcopybutton0" class="btn btn-info float-right">クリップボードにコピー</button>
    <br><br>
    
    </div>
    <br>
    
    <p>
    上のコードでわかるように、作成されたアニメーションイベントと同じ名前の関数を呼び出します。<br>
    したがって、アニメーションイベントとスクリプトは同じ名前と同じ引数を持つ必要があります。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_126.jpg"/>
    <br>
    
    <p>
    キャラクターを選択すると、InspectorにapPortraitプロパティが表示されます。<br>
    スクリプトがイベントを受信させるには、作成したスクリプトが含まれている「GameObject」を「<strong>EventListener</strong>」に設定してください。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_128.jpg"/>
    <br>
    
    <p>
    ゲームを実行すると、イベントが発生し、コンソールウィンドウでスクリプトがそれを取得してログを出力することがわかります。<br>
    </p>
    <br>
    
    <br>
    <br>
    <!-- 3. 서브 타이틀 -->
    <h3>アニメーションイベントにパラメータを追加</h3>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_127.jpg"/>
    <br>
    
    <p>
    アニメーションイベントにパラメータを追加できます。<br>
    このとき、パラメータは関数の引数として呼び出されます。<br>
    <strong>(1)</strong> <strong>「Add Parameter」ボタン</strong>を押してパラメータを追加します。<br>
    <strong>(2)</strong> <strong>「Parameter Type」</strong>を選択し、<strong>(3)</strong> で転送する値を入力します。<br>
    (パラメータとして渡すことができる型は 「<span class="text-primary">Bool、Int、Float、Vector2、String</span>」です。)<br>
    </p>
    <br>
    
    <!-- 23. 코드 예시 -->
    <div class="alert alert-warning" role="alert">
    <p>
    <br>
    <span class="text-primary">using </span>UnityEngine;<br>
    <span class="text-primary">public class </span><span class="text-success">AnimEventListener</span> : <span class="text-success">MonoBehaviour</span><br>
    {<br>
    &emsp;&emsp;<span class="text-primary">void</span> Start() { }<br>
    &emsp;&emsp;<span class="text-primary">void</span> SampleAnimEvent(<span class="text-primary">float</span> floatValue)<br>
    &emsp;&emsp;{<br>
    &emsp;&emsp;&emsp;&emsp;<span class="text-success">Debug</span>.Log(<span class="text-danger">"Sample Anim Event - " </span>+ floatValue);<br>
    &emsp;&emsp;}<br>
    }<br>
    <br>
    </p>
    <button id="scriptcopybutton1" class="btn btn-info float-right">クリップボードにコピー</button>
    <br><br>
    
    </div>
    <br>
    
    <p>
    パラメータを受け取るように関数を変更します。<br>
    変数型のパラメータを宣言します。<br>
    </p>
    <br>
    
    <p>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_129.jpg"/>
    <br>
    
    <p>
    ゲームを実行すると、パラメータの値が渡されていることがわかります。<br>
    </p>
    <br>
    
    <br>
    <br>
    <!-- 3. 서브 타이틀 -->
    <h3>アニメーションイベントを複数のフレームで連続して呼び出</h3>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_130.jpg"/>
    <br>
    
    <p>
    場合によっては、1つのフレームでイベントを発生させるのではなく、特定のフレームにわたってイベントを連続的に発生させる必要があります。<br>
    <strong>(1)</strong> 「<strong>Call Method</strong>」を「<strong>Once</strong>」から「<span class="text-danger"><strong>Continuous</strong></span>」に変更します。<br>
    <strong>(2)</strong> 「<strong>Start Frame</strong>」と「<strong>End Frame</strong>」をそれぞれ設定します。<br>
    <strong>(3)</strong> 2つのパラメータ値を指定できます。<br>
    各値は、「Start Frame」と「End Frame」によって呼び出されます。 その間に、直線的に補間された値がスクリプトに渡されます。<br>
    (「String」型は補間されないので、この機能はサポートされていません。)<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_131.jpg"/>
    <br>
    
    <p>
    「Continuous」タイプのアニメーションイベントは、異なる色のマーカーで表されます。<br>
    開始点は青で終点は緑です。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_132.jpg"/>
    <br>
    
    <p>
    「Bake」の後にゲームを実行すると、フレームごとに補間された値が呼び出されます。<br>
    </p>
    <br>
    
    <br>
    <br>
    <!-- 3. 서브 타이틀 -->
    <h3>2つ以上のパラメータを持つアニメーションイベントを作成</h3>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_133.jpg"/>
    <br>
    
    <p>
    複数のパラメータを持つアニメーションイベントを作成することもできます。<br>
    各パラメーターは異なるタイプを持つことができます。<br>
    上記の画面は、それぞれ「<strong>Integer、Float、Vector2</strong>」という3つのパラメータを持つ画面です。<br>
    (私は「<strong>MultipleParamAnimEvent</strong>」という名前の新しいアニメーションイベントを作成します。)<br>
    </p>
    <br>
    
    <!-- 23. 코드 예시 -->
    <div class="alert alert-warning" role="alert">
    <p>
    <br>
    <span class="text-primary">using </span>UnityEngine;<br>
    <span class="text-primary">public class </span><span class="text-success">AnimEventListener</span> : <span class="text-success">MonoBehaviour</span><br>
    {<br>
    &emsp;&emsp;<span class="text-primary">void </span>Start() { }<br>
    &emsp;&emsp;<span class="text-primary">void </span>MultipleParamAnimEvent(<span class="text-primary">object</span>&#91;&#93; multipleParams)<br>
    &emsp;&emsp;{<br>
    &emsp;&emsp;&emsp;&emsp;<span class="text-primary">int </span>intParam = (<span class="text-primary">int</span>)multipleParams&#91;0&#93;;<br>
    &emsp;&emsp;&emsp;&emsp;<span class="text-primary">float </span>floatParam = (<span class="text-primary">float</span>)multipleParams&#91;1&#93;;<br>
    &emsp;&emsp;&emsp;&emsp;<span class="text-success">Vector2 </span>vector2Param = (<span class="text-success">Vector2</span>)multipleParams&#91;2&#93;;<br>
    &emsp;&emsp;&emsp;&emsp;<span class="text-success">Debug</span>.Log(<span class="text-danger">"Multiple Param Anim Event"</span>);<br>
    &emsp;&emsp;&emsp;&emsp;<span class="text-success">Debug</span>.Log(<span class="text-danger">"Param 1 : "</span> + intParam);<br>
    &emsp;&emsp;&emsp;&emsp;<span class="text-success">Debug</span>.Log(<span class="text-danger">"Param 2 : "</span> + floatParam);<br>
    &emsp;&emsp;&emsp;&emsp;<span class="text-success">Debug</span>.Log(<span class="text-danger">"Param 3 : "</span> + vector2Param);<br>
    &emsp;&emsp;}<br>
    }<br>
    <br>
    </p>
    <button id="scriptcopybutton2" class="btn btn-info float-right">クリップボードにコピー</button>
    <br><br>
    
    </div>
    <br>
    
    <p>
    「<strong>Object Array</strong>」タイプの1つの引数だけが、3つの引数ではなく、関数パラメータとして使用されます。<br>
    この配列には、エディタで定義した順序でパラメータが格納されます。<br>
    変数は型キャストによって参照できます。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_134.jpg"/>
    <br>
    
    <p>
    ゲームを実行すると、3つのパラメータがスクリプトに渡されることがわかります。<br>
    </p>
    <br>
    
    <br>
    <br>
    <!-- 3. 서브 타이틀 -->
    <h3>改善されたインスペクタでのアニメーションイベント</h3>
    <br>
    
    <!-- 4. 버전 설명 -->
    <h4><span class="badge badge-secondary">1.3.4</span></h4>
    
    <p>
    AnyPortrait v1.3.4で、更新されたインスペクター（<a href="../../jp/AdvancedManual/AD_InspectorUI.html">関連ページ</a>）を通って、アニメーションイベントをすばやく確認することができます。<br>
    また、アニメーションイベントをスクリプトにコピーするか、呼び出し方式を変えることが可能です。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1324.jpg"/>
    <br>
    
    <p>
    アニメーションイベントを持ったキャラクターをUnityシーンから選択すれば、上記のような画面がインスペクタに表示されます。<br>
    <strong>(1)</strong> アニメの呼び出し方式を「<strong>Send Message</strong>」と「<strong>Callback</strong>」の中から選択することができます。従来の方式では、「<strong>Send Message</strong>」です。<br>
    <strong>(2)</strong> アニメのイベントを受信して処理する「リスナー（Listener）」オブジェクトです。（既存のInspector上に存在していた、このトピックの位置が変わりました。）<br>
    <strong>(3)</strong> アニメイベントです。イベントの名前とパラメータを確認することができます。<br>
    <strong>(4)</strong> アニメイベントを「クリップボード」にコピーします。コピーされたフォームは、C#スクリプトで貼り付けることができるよう加工されます。<br>
    <strong>(5)</strong> すべてのアニメーションイベントをクリップボードにコピーします。<br>
    </p>
    <br>
    
    <p>
    ここで追加された機能である「クリップボードにアニメーションイベントをコピーする」機能を使ってみましょう。<br>
    まず、<strong>(4)</strong>または<strong>(5)</strong>のコピーボタンを押します。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1325.jpg"/>
    <br>
    
    <p>
    スクリプトエディタを開いて貼り付けをすると、上記のよう、アニメーションイベントの名前、種類に合ったコードが追加されます。<br>
    今、アニメーションイベントを覚えて作成する余計な手間を避けることができます。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1326.jpg"/>
    <br>
    
    <p>
    v1.3.4で追加されたもう一つの特徴は、「<strong>Callback</strong>」方式です。<br>
    既存の「<strong>Send Message</strong>」が「<strong>Unity Send Message</strong>」を利用したものであれば、これは、関数を直接指定する「<strong>Unity Event</strong>」と同様の方法です。<br>
    性能の向上はもちろんのこと、イベントを受信する関数の名前を同じに設定する必要がない利点があります。<br>
    （実際には「Unity Event」を使用しなかったが、私たちは、ユーザーが「Unity Event」のように使用できるように、ほぼ同様に開発しました。）<br>
    <strong>(1)</strong> 「<strong>Event Method</strong>」を「<strong>Callback</strong>」に変更してみましょう。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1327.jpg"/>
    <br>
    
    <p>
    既存の「<strong>Event Listener</strong>」がなくなり、各イベントの呼び出しのターゲットを指定することができるようUIが変更されます。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1328.jpg"/>
    <br>
    
    <p>
    <strong>(1)</strong> <strong>+</strong>ボタンを押します。<br>
    <strong>(2)</strong> イベントリスナーとコールバック関数を設定できる項目が追加されます。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1329.jpg"/>
    <br>
    
    <p>
    <strong>(1)</strong> シーンでイベントを受け取る「Monobehaviour」オブジェクトを割り当てます。<br>
    <strong>(2)</strong> 右側の空白をクリックすると、イベントを受け取ることができる関数の一覧が表示されます。適切な関数を選択します。<br>
    もし1つの「GameObject」に二つ以上の「Monobehaviour」コンポーネントが追加されている場合は、関数の一覧を通しリスナーを交換することができます。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1330.jpg"/>
    <br>
    
    <p>
    <strong>(1)</strong> 同じように、1つのイベントを同時に複数のリスナーで受け取るか、または複数の関数で受けることができるように設定することができます。<br>
    <strong>(2)</strong> 項目を削除したい場合は、<strong>-</strong>ボタンを押します。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1331.jpg"/>
    <br>
    
    <p>
    コールバック関数を指定するときは、イベントの種類（パラメータの数、種類、順番）に合った関数がない場合は、上記のようにリストには何も出ません。<br>
    </p>
    <br>
    
    <p>
    どのような方法を使用しても、あなたのスクリプトが、アニメーションイベントを受けて動作するようにすることができます。<br>
    自分に合った方法を使用してみてください！<br>
    </p>
    <br>
    
    <br>
    <br>
    <!-- 3. 서브 타이틀 -->
    <h3>改善されたアニメーションイベントマーカー</h3>
    <br>
    
    <!-- 4. 버전 설명 -->
    <h4><span class="badge badge-secondary">1.4.0</span></h4>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1751.jpg"/>
    <br>
    
    <p>
    タイムラインでイベントを簡単に区別するために、イベントマーカーの色を設定するオプションが追加されました。<br>
    <strong>(1)</strong> アニメーションイベントを選択します。<br>
    <strong>(2)</strong> 「<strong>Marker Color</strong>」の値を変更してみましょう。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1752.jpg"/>
    <br>
    
    <p>
    <strong>(1)</strong> タイムラインUIでアニメーションイベントマーカーアイコンの色が変わったことがわかります。<br>
    <strong>(2)</strong> イベントリストでもどの色が設定されているかを見ることができます。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1759.jpg"/>
    <br>
    
    <p>
    また、「<strong>Continuous</strong>」タイプのイベントのマーカーがタイムラインUIでより直感的に表示されるように改善されました。<br>
    </p>
    <br>
    
    <br>
    <br>
    <!-- 3. 서브 타이틀 -->
    <h3>アニメイベントプリセット</h3>
    <br>
    
    <!-- 4. 버전 설명 -->
    <h4><span class="badge badge-secondary">1.4.0</span></h4>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1750.jpg"/>
    <br>
    
    <p>
    同じ名前のアニメーションイベントが複数のアニメーションで呼び出される場合は、それを再利用するために保存する機能があると便利です。<br>
    「AnyPortrait v1.4.0」にアニメーションイベントをプリセットとして保存して活用できる機能が追加されました。<br>
    <strong>(1)</strong> アニメーションイベントダイアログの左側には、既存のものと同じように、現在のアニメーションのイベントリストと選択したイベントのプロパティが表示されます。<br>
    <strong>(2)</strong> ダイアログの右側には、新しく追加された「アニメーションイベントプリセット」が表示されます。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1753.jpg"/>
    <br>
    
    <p>
    <strong>(1)</strong> 保存したいアニメーションイベントを選択します。<br>
    <strong>(2)</strong> 「<strong>Save as Preset</strong>」ボタンを押します。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1754.jpg"/>
    <br>
    
    <p>
    <strong>(1)</strong> アニメイベントプリセットリストに選択したイベントが追加されました。<br>
    <strong>(2)</strong> プリセットを選択すると、そのプリセットの属性が表示されます。<br>
    <strong>(3)</strong> 選択したプリセットを削除したい場合は、「<strong>Remove Event Preset</strong>」ボタンを押します。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1755.jpg"/>
    <br>
    
    <p>
    この機能は同じアニメーションだけでなく、他のアニメーションにも使用できます。<br>
    保存したプリセットを使って別のアニメーションにイベントを追加しましょう。<br>
    <strong>(1)</strong> 別のアニメーションを選択します。<br>
    <strong>(2)</strong> イベントを追加する位置にタイムスライダを移動します。<br>
    <strong>(3)</strong> 「<strong>Animation Events</strong>」ボタンを押します。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1756.jpg"/>
    <br>
    
    <p>
    <strong>(1)</strong> 「<strong>Add Event</strong>」ボタンを押します。<br>
    <strong>(2)</strong> 追加したイベントを選択します。<br>
    <strong>(3)</strong> 適用したいプリセットを選択します。<br>
    <strong>(4)</strong> 「<strong>Apply Selected Preset</strong>」ボタンを押します。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1757.jpg"/>
    <br>
    
    <p>
    <strong>(5)</strong> 案内メッセージを確認し、「適用」ボタンを押します。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1758.jpg"/>
    <br>
    
    <p>
    プリセットとして保存されたアニメーションイベント情報がコピーされ、ターゲットに適用されたことがわかります。<br>
    </p>
    <br>
    
    <!-- 12. 참고 박스 시작 -->
    <div class="alert alert-info" role="alert">
    
    <!-- 3. 서브 타이틀(참고 박스) -->
    <h4>現在のフレームにプリセットによるイベントを直接生成</h4>
    <br>
    
    <!-- 4. 버전 설명 -->
    <h4><span class="badge badge-secondary">1.4.5</span></h4>
    
    <p>
    「イベントの作成」と「プリセットの適用」のステップを短縮できます。<br>
    フレームを選択してプリセットが適用されたイベントを一度に生成しましょう。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1846.jpg"/>
    <br>
    
    <p>
    <strong>(1)</strong> イベントが生成される位置にタイムスライダを移動します。<br>
    <strong>(2)</strong> プリセットを選択します。<br>
    <strong>(3)</strong> 「<strong>Add Event by Preset</strong>」ボタンを押すと、そのフレームに直接プリセットが適用されたイベントが生成されます。<br>
    </p>
    <br>
    
    </div>
    <br>
    <br>
    
    <!-- 12. 참고 박스 시작 -->
    <div class="alert alert-info" role="alert">
    
    <!-- 3. 서브 타이틀(참고 박스) -->
    <h4>プリセットのカテゴリを指定</h4>
    <br>
    
    <!-- 4. 버전 설명 -->
    <h4><span class="badge badge-secondary">1.4.5</span></h4>
    
    <p>
    イベントプリセットが多すぎると、リストで毎回必要なプリセットを見つけるのが難しくなります。<br>
    このとき、「カテゴリ」を利用すれば、使用目的が似たプリセットをまとめて管理できます。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1847.jpg"/>
    <br>
    
    <p>
    <strong>(1)</strong> プリセットを選択します。<br>
    <strong>(2)</strong> 「<strong>Category</strong>」属性を変更してみましょう。<br>
    現在は登録されているカテゴリがないので、新しいカテゴリを登録するために「<strong>+ New Category..</strong>」を選択します。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1848.jpg"/>
    <br>
    
    <p>
    新しいカテゴリの名前を設定します。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1849.jpg"/>
    <br>
    
    <p>
    生成されたカテゴリを別のプリセットに適用しましょう。<br>
    <strong>(1)</strong> 別のプリセットを選択します。<br>
    <strong>(2)</strong> 「<strong>Category</strong>」属性を選択すると、作成したカテゴリが追加されたことがわかります。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1850.jpg"/>
    <br>
    
    <p>
    <strong>(1)</strong> プリセットリストの上部でカテゴリを変更できます。<br>
    「<strong>Everything</strong>」以外のカテゴリを選択すると、リストにはそのカテゴリのプリセットのみが表示されます。<br>
    </p>
    <br>
    
    <p>
    特定のカテゴリを持つプリセットが1つもない場合、そのカテゴリは自動的に削除されます。<br>
    </p>
    <br>
    
    </div>
    <br>
    <br>
    
    <br>
    <br>
    <!-- 3. 서브 타이틀 -->
    <h3>無効なイベント名を修正</h3>
    <br>
    
    <!-- 4. 버전 설명 -->
    <h4><span class="badge badge-secondary">1.4.1</span></h4>
    
    <p>
    アニメーションイベントはスクリプトから呼び出される必要があるため、可能なスクリプト作成規則に合わせて名前を付ける必要があります。<br>
    - 「アルファベット、数字、アンダースコア（"_"）」の組み合わせでのみ名前を付ける必要があり、スペースは許可されません。<br>
    - 「空名」は使用できません。<br>
    - 呼び出し方式が「Send Message」の場合、「オーバーロード」を許可しません。 つまり、異なるパラメータの組み合わせを持つ同じ名前のイベントが2つ以上存在してはいけません。<br>
    </p>
    <br>
    
    <p>
    イベントの名前が無効な場合は、名前を自動的に変更する機能を利用できます。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1796.jpg"/>
    <br>
    
    <p>
    <strong>(1)</strong> アニメイベントの名前を「Sample Event Name(!)」のように作成しました。 規則によると、この名前は特殊文字とスペースがあるため無効です。<br>
    <strong>(2)</strong> イベント名が有効でない理由を示すメッセージが表示されます。<br>
    <strong>(3)</strong> 「<strong>Fix now</strong>」ボタンを押すと自動的に名前が変更されます。 （ただし、有効な文字が1つでもない場合は修正されません。）<br>
    </p>
    <br>
    
    <br>
    <br>
    <!-- 3. 서브 타이틀 -->
    <h3>Callback方式では、イベントリスナーを簡単に割り当</h3>
    <br>
    
    <!-- 4. 버전 설명 -->
    <h4><span class="badge badge-secondary">1.4.1</span></h4>
    
    <p>
    「Callback」方式でアニメーションイベントを呼び出すことは、複数のイベントリスナーを設定できるという利点があります。<br>
    しかし、すべてのイベントにイベントリスナーを割り当てるのは面倒です。<br>
    この作業を簡単にする機能を利用しましょう。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1797.jpg"/>
    <br>
    
    <p>
    <strong>(1)</strong> AnyPortraitで作成したキャラクターと「イベントリスナー」として機能するGameObjectがシーンに配置されています。<br>
    <strong>(2)</strong> イベント呼び出し方式を「Callback」に設定しました。<br>
    <strong>(3)</strong> 「Assign Listener to All Events」の「<strong>Target</strong>」に「イベントリスナー」である「」GameObject」を割り当てます。<br>
    <strong>(4)</strong> 「<strong>Assign</strong>」ボタンを押します。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1798.jpg"/>
    <br>
    
    <p>
    上記のように、すべてのイベントに共通のイベントリスナーが割り当てられていることがわかります。<br>
    これで、イベントに合ったイベントリスナーの関数を設定するだけです。<br>
    </p>
    <br>
    
    <br>
    <br>
    <!-- 3. 서브 타이틀 -->
    <h3>Callback方式では、関数の検証</h3>
    <br>
    
    <!-- 4. 버전 설명 -->
    <h4><span class="badge badge-secondary">1.4.1</span></h4>
    
    <p>
    「Callback」方式のイベントが呼び出す関数を割り当てるとき、次の場合には設定された関数を呼び出すことはできません。<br>
    - イベントリスナーが存在しないとき<br>
    - 保存された名前の関数がイベントリスナーにない場合<br>
    - 保存された名前の関数が「オーバーロード」関数の場合<br>
    </p>
    <br>
    
    <p>
    幸いなことに、無効なコールバック関数によってゲーム中に致命的なエラーが発生するわけではありません。<br>
    しかし、設定されたイベントが有効であるか、毎回ゲームを実行してテストすることはできません。<br>
    無効なイベントを自動的に削除する機能を試してみましょう。<br>
    </p>
    <br>
    
    <p>
    イベントリスナーに次のコールバック関数が定義されているとしましょう。<br>
    </p>
    <br>
    
    <!-- 23. 코드 예시 -->
    <div class="alert alert-warning" role="alert">
    <p>
    <br>
    private void <strong>OnAnimEvent_A</strong> () { Debug.Log("Event A"); }<br>
    <br>
    private void <strong>OnAnimEvent_A</strong> ( <span class="text-danger"><strong>float floatValue</strong></span> ) { Debug.Log("Event A (Overloaded)"); }<br>
    <br>
    </p>
    <button id="scriptcopybutton3" class="btn btn-info float-right">クリップボードにコピー</button>
    <br><br>
    
    </div>
    <br>
    
    <p>
    2つの関数は同じ名前ですが、パラメータが異なる「オーバーロード」関係です。<br>
    イベントコールバックルールによると、これらの関数は無効です。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1799.jpg"/>
    <br>
    
    <p>
    <strong>(1)</strong> 上記のコードを含むイベントリスナーと関数が設定された状態です。 無効な関数（"OnAnimEvent_A"）が設定されていますが、確認するのは難しいです。<br>
    <strong>(2)</strong> 「<strong>Validate Events</strong>」ボタンを押します。<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1800.jpg"/>
    <br>
    
    <p>
    検証を実行すると、無効な関数は上記のように自動的に削除されます。<br>
    </p>
    <br>
    
    <!-- 5. 바닥 네비바 -->
    <br>
    <br>
    <br>
    <br>
    <nav class="navbar fixed-bottom navbar-light bg-light">
        <a class="btn btn-light" role="button" href="../../jp/AdvancedManual/AD_ExportImportAnimation.html">< アニメーションをエクスポート/インポート</a>
        <a class="btn btn-light" role="button" href="../../jp/AdvancedManual/AD_CopyBonePose.html">骨のポーズをコピー/貼り付け ></a>
    </nav>
    
    <!-- 페이지 내용 끝! -->

    
    <!-- 종료 -->
    </div>

    <!-- 부트스트랩 -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script type="text/javascript" src="../../js/bootstrap.js"></script>
    <!--------------->

    <!-- 클립보드 스크립트 -->
    <script>
    document.getElementById("scriptcopybutton0").addEventListener("click", function() {
    const textToCopy = "using UnityEngine;\npublic class AnimEventListener : MonoBehaviour\n{\n\tvoid Start() { }\n\tvoid SampleAnimEvent()\n\t{\n\t\tDebug.Log(\"Sample Anim Event\");\n\t}\n}\n";
    navigator.clipboard.writeText(textToCopy).then(() => {
        alert("スクリプトがクリップボードにコピーされました。");
    }).catch(err => {
        console.error("クリップボードのコピーに失敗しました", err);
    });
    });
    </script>
    
    <script>
    document.getElementById("scriptcopybutton1").addEventListener("click", function() {
    const textToCopy = "using UnityEngine;\npublic class AnimEventListener : MonoBehaviour\n{\n\tvoid Start() { }\n\tvoid SampleAnimEvent(float floatValue)\n\t{\n\t\tDebug.Log(\"Sample Anim Event - \" + floatValue);\n\t}\n}\n";
    navigator.clipboard.writeText(textToCopy).then(() => {
        alert("スクリプトがクリップボードにコピーされました。");
    }).catch(err => {
        console.error("クリップボードのコピーに失敗しました", err);
    });
    });
    </script>
    
    <script>
    document.getElementById("scriptcopybutton2").addEventListener("click", function() {
    const textToCopy = "using UnityEngine;\npublic class AnimEventListener : MonoBehaviour\n{\n\tvoid Start() { }\n\tvoid MultipleParamAnimEvent(object[] multipleParams)\n\t{\n\t\tint intParam = (int)multipleParams[0];\n\t\tfloat floatParam = (float)multipleParams[1];\n\t\tVector2 vector2Param = (Vector2)multipleParams[2];\n\t\tDebug.Log(\"Multiple Param Anim Event\");\n\t\tDebug.Log(\"Param 1 : \" + intParam);\n\t\tDebug.Log(\"Param 2 : \" + floatParam);\n\t\tDebug.Log(\"Param 3 : \" + vector2Param);\n\t}\n}\n";
    navigator.clipboard.writeText(textToCopy).then(() => {
        alert("スクリプトがクリップボードにコピーされました。");
    }).catch(err => {
        console.error("クリップボードのコピーに失敗しました", err);
    });
    });
    </script>
    
    <script>
    document.getElementById("scriptcopybutton3").addEventListener("click", function() {
    const textToCopy = "private void OnAnimEvent_A () { Debug.Log(\"Event A\"); }\n\nprivate void OnAnimEvent_A ( float floatValue ) { Debug.Log(\"Event A (Overloaded)\"); }\n";
    navigator.clipboard.writeText(textToCopy).then(() => {
        alert("スクリプトがクリップボードにコピーされました。");
    }).catch(err => {
        console.error("クリップボードのコピーに失敗しました", err);
    });
    });
    </script>
    

    <!--------------->

    </body>
</html>
