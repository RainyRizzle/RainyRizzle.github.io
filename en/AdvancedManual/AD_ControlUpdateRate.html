<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <!-- 제목 -->
        <title>Controlling update rate with scripts</title>
        <!-- 파비콘 -->
        <link rel="shortcut icon" href="../../Images/favicon.ico"/>
        <!-- 부트스트랩 -->
        <link rel="stylesheet" href="../../css/bootstrap.css">
        <!--------------->

    </head>

    <body>
        <p>
            <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark">
            <!--로고 : AnyPortrait 홈페이지로 가야한다. (언어별)-->
            <a class="navbar-brand" href="https://www.rainyrizzle.com/anyportrait-eng">
                <img src="../../Images/AP_Logo.png" width="150" height="30" class="d-inline-block align-top" alt="">
            </a>

            <!--메뉴들 : 현재 페이지의 카테고리에 active 붙인다. (언어별 링크) -->
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarText">
                <ul class="navbar-nav mr-auto">
                <li class="nav-item">
                    <a class="nav-link" href="../../en/GettingStarted.html">Getting Started</a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="../../en/AdManual.html">Manual</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../en/Script.html">Script</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://www.rainyrizzle.com/ap-videotutorial-eng">Video</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://www.rainyrizzle.com/ap-forum">Forum</a>
                </li>

                </ul>

                <!-- 언어 변경. 현재 페이지의 주소에서 언어 주소만 변경한다. (해당 언어에 active) -->
                <div class="btn-group mr-2" role="group" aria-label="Basic example">
                    <a role="button" class="btn btn-secondary active" href="../../en/AdvancedManual/AD_ControlUpdateRate.html">EN</a>
                    <a role="button" class="btn btn-secondary" href="../../kr/AdvancedManual/AD_ControlUpdateRate.html">KR</a>
                    <a role="button" class="btn btn-secondary" href="../../jp/AdvancedManual/AD_ControlUpdateRate.html">JP</a>
                </div>

                <!-- 여백 -->
                <p></p>

                <!-- 검색버튼 -->
                <form class="form-inline">
                    <a class="btn btn-light" role="button" href="../../en/Search.html">Search</a>
                </form>
            </div>
        </nav>
    </p>

    <!-- 실제 바디 부분 -->
    <div class="container">
    <br>
    <br>
    <!-- 여기에 내용을 적어주세요 -->

    <!-- 여기서부터 페이지 내용이 작성됩니다. -->
    <!-- 1. 페이지 진입 경로 -->
    <p><a href="https://www.rainyrizzle.com/anyportrait-eng"><span class="text-dark">AnyPortrait</span></a> > <a href="../../en/AdManual.html"><span class="text-dark">Manual</span></a> > Controlling update rate with scripts</p>
    
    <!-- 2. 페이지 메인 타이틀 -->
    <h1 class="display-5">Controlling update rate with scripts</h1>
    <br>
    
    <!-- 4. 버전 설명 -->
    <h4><span class="badge badge-secondary">1.3.5</span></h4>
    
    <p>
    Various directing techniques are used in games, one of which is controlling the playback speed.<br>
    You can speed up or down the overall game to provide a tense play, or you can control the animation speed of a specific character for a fun effect.<br>
    Basically, you can control the speed of the game using Unity's <strong>Time</strong> class.<br>
    In addition to this, you can control the animation playback speed of AnyPortrait's characters with a script.<br>
    This page presents an example script that controls the animation playback speed.<br>
    </p>
    <br>
    
    <p>
    The description of the script function can also be found in the <a href="../../en/Script/SC_Init.html">related page</a>.<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1542.jpg"/>
    <br>
    
    <p>
    To show an example of the script, 4 identical characters were ready as above.<br>
    The results of the example script below can be seen in the video at the bottom of the page.<br>
    </p>
    <br>
    
    <br>
    <br>
    <!-- 3. 서브 타이틀 -->
    <h3>Changing the speed of gameplay</h3>
    <br>
    
    <!-- 23. 코드 예시 -->
    <div class="alert alert-warning" role="alert">
    <p>
    <br>
    void Update()<br>
    {<br>
    &emsp;&emsp;// Press Q to return the game's speed to default (1).<br>
    &emsp;&emsp;if (Input.GetKeyDown(KeyCode.Q))<br>
    &emsp;&emsp;{<br>
    &emsp;&emsp;&emsp;&emsp;Time.timeScale = 1.0f;<br>
    &emsp;&emsp;}<br>
    <br>
    &emsp;&emsp;// Press W to make the game 3x faster.<br>
    &emsp;&emsp;if (Input.GetKeyDown(KeyCode.W))<br>
    &emsp;&emsp;{<br>
    &emsp;&emsp;&emsp;&emsp;Time.timeScale = 3.0f;<br>
    &emsp;&emsp;}<br>
    }<br>
    <br>
    </p>
    </div>
    <br>
    
    <p>
    All objects using <strong>Time.deltaTime</strong> are affected by the game speed.<br>
    Characters created with AnyPortrait are also affected by the game speed by default.<br>
    All the cases in the video below are compared when the overall game speed is 1x and 3x, respectively.<br>
    </p>
    <br>
    
    <br>
    <br>
    <!-- 3. 서브 타이틀 -->
    <h3>Method 1: Specifying the speed multiplier</h3>
    <br>
    
    <!-- 23. 코드 예시 -->
    <div class="alert alert-warning" role="alert">
    <p>
    <br>
    void Update()<br>
    {<br>
    &emsp;&emsp;// (Skipped)<br>
    &emsp;&emsp;// Press A to reset all speed options.<br>
    &emsp;&emsp;if (Input.GetKeyDown(KeyCode.A))<br>
    &emsp;&emsp;{<br>
    &emsp;&emsp;&emsp;&emsp;portraitA.<strong>SetUpdateTimeMethod(false);</strong><br>
    &emsp;&emsp;&emsp;&emsp;portraitB.<strong>SetUpdateTimeMethod(false);</strong><br>
    &emsp;&emsp;&emsp;&emsp;portraitC.<strong>SetUpdateTimeMethod(false);</strong><br>
    &emsp;&emsp;&emsp;&emsp;portraitD.<strong>SetUpdateTimeMethod(false);</strong><br>
    &emsp;&emsp;}<br>
    <br>
    &emsp;&emsp;// Press the S key to specify each speed ratio using multipliers.<br>
    &emsp;&emsp;if (Input.GetKeyDown(KeyCode.S))<br>
    &emsp;&emsp;{<br>
    &emsp;&emsp;&emsp;&emsp;portraitA.<strong>SetUpdateTimeMethod(false);</strong><br>
    &emsp;&emsp;&emsp;&emsp;portraitB.<strong>SetUpdateTimeMethod(false, 1.5f);</strong><br>
    &emsp;&emsp;&emsp;&emsp;portraitC.<strong>SetUpdateTimeMethod(true);</strong><br>
    &emsp;&emsp;&emsp;&emsp;portraitD.<strong>SetUpdateTimeMethod(true, 1.5f);</strong><br>
    &emsp;&emsp;}<br>
    }<br>
    <br>
    </p>
    </div>
    <br>
    
    <p>
    <strong>SetUpdateTimeMethod(bool useUnscaleDeltaTime, float multiplier)</strong> function sets the animation speed by multiplying by a constant speed ratio based on the update rate of the entire game.<br>
    - <strong>bool useUnscaleDeltaTime</strong> : If you enter the default value of <strong>false</strong>, the game speed (Time.timeScale) will be affected. If you enter <strong>true</strong>, the game speed is not affected.<br>
    - <strong>float multiplier</strong> : The update time is determined by multiplying the update rate of the entire game by a certain percentage. If not entered, it is multiplied by 1.<br>
    </p>
    <br>
    
    <p>
    If you want to restore the speed ratio to the default, write as "<strong>SetUpdateTimeMethod(false)</strong>".<br>
    </p>
    <br>
    
    <br>
    <br>
    <!-- 3. 서브 타이틀 -->
    <h3>Method 2: Using a callback function</h3>
    <br>
    
    <!-- 23. 코드 예시 -->
    <div class="alert alert-warning" role="alert">
    <p>
    <br>
    void Update()<br>
    {<br>
    &emsp;&emsp;// (Skipped)<br>
    &emsp;&emsp;// When the D key is pressed, the playback speed is changed by a callback function.<br>
    &emsp;&emsp;if (Input.GetKeyDown(KeyCode.D))<br>
    &emsp;&emsp;{<br>
    &emsp;&emsp;&emsp;&emsp;portraitA.<strong>SetUpdateTimeMethod(OnDeltaTimeRequested, portraitA);</strong><br>
    &emsp;&emsp;&emsp;&emsp;portraitB.<strong>SetUpdateTimeMethod(OnDeltaTimeRequested, portraitB);</strong><br>
    &emsp;&emsp;&emsp;&emsp;portraitC.<strong>SetUpdateTimeMethod(OnDeltaTimeRequested, portraitC);</strong><br>
    &emsp;&emsp;&emsp;&emsp;portraitD.<strong>SetUpdateTimeMethod(OnDeltaTimeRequested, portraitD);</strong><br>
    &emsp;&emsp;}<br>
    }<br>
    <br>
    // This is a callback function that returns the playback speed for each apPortrait.<br>
    private float <strong>OnDeltaTimeRequested</strong>(object savedObject)<br>
    {<br>
    &emsp;&emsp;// Returns a different playback speed depending on the stored object.<br>
    &emsp;&emsp;if (savedObject == (object)portraitA)<br>
    &emsp;&emsp;{<br>
    &emsp;&emsp;&emsp;&emsp;return Time.deltaTime / 2.0f;<br>
    &emsp;&emsp;}<br>
    &emsp;&emsp;else if (savedObject == (object)portraitB)<br>
    &emsp;&emsp;{<br>
    &emsp;&emsp;&emsp;&emsp;return Time.deltaTime * 3.0f;<br>
    &emsp;&emsp;}<br>
    &emsp;&emsp;else if (savedObject == (object)portraitC)<br>
    &emsp;&emsp;{<br>
    &emsp;&emsp;&emsp;&emsp;return Time.unscaledDeltaTime / 2.0f;<br>
    &emsp;&emsp;}<br>
    &emsp;&emsp;else if (savedObject == (object)portraitD)<br>
    &emsp;&emsp;{<br>
    &emsp;&emsp;&emsp;&emsp;return Time.unscaledDeltaTime * 3.0f;<br>
    &emsp;&emsp;}<br>
    &emsp;&emsp;return Time.deltaTime;<br>
    }<br>
    <br>
    </p>
    </div>
    <br>
    
    <p>
    The "<strong>SetUpdateTimeMethod(OnDeltaTimeRequested onDeltaTimeRequested, object savedObject)</strong>" function gives you more flexibility to change the playback speed.<br>
    All we need to do is return the game time of the frame in which this function is called, and we can change the return value to make the animation play faster or slower.<br>
    The cool thing about this method is that you can change the returned game time value in runtime.<br>
    For example, in a game, you can easily express using this function that a character is slowed down for a certain period of time due to "slow magic skill".<br>
    Or it's easy to express a gradual change in playback speed.<br>
    If you input <strong>savedObject</strong>, you can identify which character this function is being called for, as shown above.<br>
    "<strong>Time.deltaTime</strong>" can be used to make the game speed affected.<br>
    Conversely, you can use "<strong>Time.unscaledDeltaTime</strong>" to create an object that is not affected by game speed.<br>
    It is also possible to implement your own system to create a separate game speed different from Unity's time.<br>
    </p>
    <br>
    
    <p>
    Check out the video below to see the difference in playback speed in each of the above cases.<br>
    </p>
    <br>
    
    <!-- 11. 유튜브 영상 -->
    <div class="embed-responsive embed-responsive-16by9 mx-auto d-block" style="max-width: 60%;">
        <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/PKiktsprN68" allowfullscreen></iframe>
    </div>
    <br>
    
    <p>
    <span class="text-danger"><strong>Note</strong></span><br>
    These above functions have the following limitations.<br>
    - It does not apply when using Mecanim. In this case, it follows Mecanim's speed.<br>
    - It does not apply to physics features.<br>
    </p>
    <br>
    
    <!-- 5. 바닥 네비바 -->
    <br>
    <br>
    <br>
    <br>
    <nav class="navbar fixed-bottom navbar-light bg-light">
        <a class="btn btn-light" role="button" href="../../en/AdvancedManual/AD_MultipleDirectionCharacter.html">< Creating a character in multiple directions</a>
        <a class="btn btn-light" role="button" href="../../en/AdvancedManual/AD_URPOutlineShader.html">Creating a URP Outline Shader ></a>
    </nav>
    
    <!-- 페이지 내용 끝! -->

    
    <!-- 종료 -->
    </div>

    <!-- 부트스트랩 -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script type="text/javascript" src="../../js/bootstrap.js"></script>
    <!--------------->

    </body>
</html>
