<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <!-- 제목 -->
        <title>성능 향상시키기</title>
        <!-- 파비콘 -->
        <link rel="shortcut icon" href="../../Images/favicon.ico"/>
        <!-- 부트스트랩 -->
        <link rel="stylesheet" href="../../css/bootstrap.css">
        <!--------------->

    </head>

    <body>
        <p>
            <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark">
            <!--로고 : AnyPortrait 홈페이지로 가야한다. (언어별)-->
            <a class="navbar-brand" href="https://www.rainyrizzle.com/anyportrait-kor">
                <img src="../../Images/AP_Logo.png" width="150" height="30" class="d-inline-block align-top" alt="">
            </a>

            <!--메뉴들 : 현재 페이지의 카테고리에 active 붙인다. (언어별 링크) -->
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarText">
                <ul class="navbar-nav mr-auto">
                <li class="nav-item">
                    <a class="nav-link" href="../../kr/GettingStarted.html">시작하기</a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="../../kr/AdManual.html">메뉴얼</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../kr/Script.html">스크립트</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://www.rainyrizzle.com/ap-videotutorial-kor">동영상</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://www.rainyrizzle.com/ap-forum">게시판</a>
                </li>

                </ul>

                <!-- 언어 변경. 현재 페이지의 주소에서 언어 주소만 변경한다. (해당 언어에 active) -->
                <div class="btn-group mr-2" role="group" aria-label="Basic example">
                    <a role="button" class="btn btn-secondary" href="../../en/AdvancedManual/AD_ImprovePerformance.html">EN</a>
                    <a role="button" class="btn btn-secondary active" href="../../kr/AdvancedManual/AD_ImprovePerformance.html">KR</a>
                    <a role="button" class="btn btn-secondary" href="../../jp/AdvancedManual/AD_ImprovePerformance.html">JP</a>
                </div>

                <!-- 여백 -->
                <p></p>

                <!-- 검색버튼 -->
                <form class="form-inline">
                    <a class="btn btn-light" role="button" href="../../kr/Search.html">검색</a>
                </form>
            </div>
        </nav>
    </p>

    <!-- 실제 바디 부분 -->
    <div class="container">
    <br>
    <br>
    <!-- 여기에 내용을 적어주세요 -->

    <!-- 여기서부터 페이지 내용이 작성됩니다. -->
    <!-- 1. 페이지 진입 경로 -->
    <p><a href="https://www.rainyrizzle.com/anyportrait-kor"><span class="text-dark">AnyPortrait</span></a> > <a href="../../kr/AdManual.html"><span class="text-dark">메뉴얼</span></a> > 성능 향상시키기</p>
    
    <!-- 2. 페이지 메인 타이틀 -->
    <h1 class="display-5">성능 향상시키기</h1>
    <br>
    
    <!-- 4. 버전 설명 -->
    <h4><span class="badge badge-secondary">1.3.2</span></h4>
    
    <p>
    게임을 만들 때 실행 성능을 향상시키는 작업은 매우 중요하지만 그만큼 어려운 일입니다.<br>
    마찬가지로, AnyPortrait를 이용하여 게임을 만들 때에도 성능에 관한 이슈는 조심스럽게 관리되어야 합니다.<br>
    이 페이지에서 설명하는 몇가지 요소들은 성능 최적화에 큰 도움이 될 것입니다.<br>
    </p>
    <br>
    
    <p>
    <span class="text-danger"><strong>참고</strong></span><br>
    - 이 페이지에서의 성능 테스트는 실행 환경에 따라서 결과가 다를 수 있습니다.<br>
    - GPU 최적화에 대해서는 <a href="../../kr/AdvancedManual/AD_ReduceDrawCalls.html">관련 페이지</a>를 참고해주세요.<br>
    - 높은 FPS를 확인하기 위해서 VSync 옵션을 비활성화하여 빌드했습니다.<br>
    </p>
    <br>
    
    <br>
    <br>
    <!-- 3. 서브 타이틀 -->
    <h3>최신 버전의 AnyPortrait 이용하기</h3>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1276.jpg"/>
    <br>
    
    <p>
    저희 팀은 지속적으로 AnyPortrait의 기본적인 성능을 향상시키고자 노력하고 있습니다.<br>
    이전 버전인 v1.3.0/v1.3.1에서 상당한 애니메이션과 리깅에 대해서 높은 성능 향상을 기록했습니다.<br>
    v1.3.2에서는 리깅과 버텍스 처리에 대한 성능 향상 및 메모리 할당 문제를 해결하였습니다.<br>
    최신 버전의 AnyPortrait로 업데이트하는 것은 여러분들의 게임 성능 향상에 도움이 될 것입니다.<br>
    (위 프로파일링 결과는 아래에 설명하는 예제를 유니티 에디터 상에서 테스트한 결과입니다.)<br>
    </p>
    <br>
    
    <br>
    <br>
    <!-- 3. 서브 타이틀 -->
    <h3>버텍스 개수와 성능</h3>
    <br>
    
    <p>
    AnyPortrait는 CPU 기반의 버텍스 처리를 하기 때문에, 버텍스 개수가 늘어날 수록 성능이 저하됩니다.<br>
    메시에 버텍스가 많아지면 그만큼 정밀하게 표현할 수 있는 반면, 높은 성능을 기대하기 어렵습니다.<br>
    반대로 버텍스가 너무 적다면 애니메이션에서 외형이 어색해질 수 있습니다.<br>
    따라서 적절한 개수의 버텍스로 메시를 구성하는 것이 매우 중요합니다.<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1227.jpg"/>
    <br>
    
    <p>
    버텍스에 따른 성능 비교를 위해 간단한 예제를 준비했습니다.<br>
    1개의 메시와 2개의 본들로 구성된 관절 애니메이션 샘플을 위와 같이 만들었습니다.<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1228.jpg"/>
    <br>
    
    <p>
    같은 애니메이션을 하지만 버텍스 개수가 다르도록 샘플을 3개로 나누어서 준비했습니다.<br>
    동일한 이미지에 대해서 12개, 42개, 86개의 버텍스들을 각각 가지도록 메시를 만들었습니다.<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1229.jpg"/>
    <br>
    
    <p>
    적은 수의 버텍스로 리깅을 적용한 화면입니다.<br>
    관절 부분에서 다소 거칠게 접히는 모습이 보이지만, 크게 이상하지는 않아 보입니다.<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1230.jpg"/>
    <br>
    
    <p>
    메시에 버텍스가 많은 경우의 리깅을 적용한 화면입니다.<br>
    리깅 가중치를 세밀하게 적용할 수 있어서 상대적으로 관절 부분의 표현이 자연스럽습니다.<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1231.jpg"/>
    <br>
    
    <p>
    관절이 접혔다가 펴지는 간단한 애니메이션을 만들었습니다.<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1232.jpg"/>
    <br>
    
    <p>
    동일한 애니메이션을 3개의 샘플에 적용했을 때의 모습입니다.<br>
    버텍스가 많을 수록 관절 부분의 표현이 정밀한 것을 볼 수 있습니다.<br>
    이 결과만 보면 버텍스가 많은 경우 애니메이션 품질이 더 좋아보입니다.<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1233.jpg"/>
    <br>
    
    <p>
    이제 성능을 테스트해봅시다.<br>
    이 간단한 샘플이 위와 같이 100개 배치되도록 스크립트를 작성하였습니다.<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1234.jpg"/>
    <br>
    
    <p>
    실시간으로 FPS(Frames Per Second)의 평균, 최소, 최대값을 볼 수 있도록 스크립트를 작성하였습니다.<br>
    이 씬을 Windows용 PC 앱으로 빌드한 이후 테스트하여 아래와 같은 결과를 확인했습니다.<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1235.jpg"/>
    <br>
    
    <p>
    위 그래프는 버텍스의 개수에 따라 FPS가 어떻게 바뀌는지 보여줍니다.<br>
    적은 수의 버텍스로 메시를 구성한 경우(Low)엔 평균적으로 650 FPS라는 높은 실행 성능이 기록되었습니다.<br>
    반대로, 많은 수의 버텍스로 메시들이 있는 경우(High)엔 평균적으로 270 FPS의 낮은 실행 성능이 기록되었습니다.<br>
    (FPS가 높을 수록 성능이 좋은 것을 의미합니다.)<br>
    </p>
    <br>
    
    <p>
    즉, 버텍스 개수에 따라 성능이 줄어드는 것을 볼 수 있습니다.<br>
    애니메이션 품질과 실행 성능을 모두 고려하여, 적절한 수준의 버텍스 밀도를 유지하면서 캐릭터를 만드는 것을 권장합니다.<br>
    </p>
    <br>
    
    <br>
    <br>
    <!-- 3. 서브 타이틀 -->
    <h3>물리 효과 구현 방식과 성능</h3>
    <br>
    
    <p>
    물리 효과는 게임 엔진에서 성능에 크게 영향을 주는 요소입니다.<br>
    AnyPortrait에도 물리 효과를 구현하는 두가지 방식이 있습니다.<br>
    <strong>물리(Physics) 모디파이어</strong>와 <strong>지글 본(Jiggle Bones)</strong>이 그것입니다.<br>
    이 두가지 기능을 사용할 경우 실행 성능이 어떻게 나타나는지 확인해봅시다.<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1236.jpg"/>
    <br>
    
    <p>
    데모에 등장하는 캐릭터에 각각 <strong>물리 모디파이어</strong>, <strong>지글 본</strong>, 그리고 아무것도 적용하지 않은 3개의 샘플을 준비했습니다.<br>
    <strong>물리 모디파이어</strong>는 위 이미지와 같이 일부 메시에 적용되었습니다.<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1237.jpg"/>
    <br>
    
    <p>
    다른 샘플에는 <strong>지글 본</strong>을 적용하여 유사한 물리 움직임을 보여주도록 설정했습니다.<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1238.jpg"/>
    <br>
    
    <p>
    위와 마찬가지로 30개의 캐릭터가 등장하여 애니메이션되는 동안 FPS를 기록하도록 스크립트를 작성한 후, PC 앱으로 빌드하여 성능 테스트를 진행했습니다.<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1239.jpg"/>
    <br>
    
    <p>
    물리 효과를 적용하지 않은 경우에는 100 이상의 높은 FPS를 기록하였으며, 이를 기준으로 다른 물리 효과의 성능 기록을 비교해봅시다.<br>
    <strong>지글 본</strong>을 적용한 경우는 물리 효과를 적용하지 않은 경우보다 10 정도의 FPS 저하가 있었습니다.<br>
    <strong>물리 모디파이어</strong>를 적용한 경우엔 무려 30의 FPS 저하가 기록되었습니다.<br>
    특히, <strong>물리 모디파이어</strong>를 적용한 경우의 최소 FPS는 매우 낮은 것을 볼 수 있었습니다.<br>
    </p>
    <br>
    
    <p>
    <strong>물리 모디파이어</strong>는 버텍스마다 물리 재질에 따른 연산을 하기 때문에 성능 저하가 큰 기능입니다.<br>
    따라서 <strong>물리 모디파이어</strong>는 <strong>고정 프레임</strong>으로 동작하도록 개발되었습니다.<br>
    <strong>물리 모디파이어</strong>가 동작하는 프레임과 그렇지 않은 프레임의 격차가 꽤 크며, 이로 인하여 최소 FPS가 매우 낮게 나타난 것입니다.<br>
    </p>
    <br>
    
    <p>
    반면, <strong>지글 본</strong>은 상대적으로 버텍스 개수보다 적은 본을 대상으로 하며, 연산량이 매우 적은 기능입니다.<br>
    실제로 <strong>지글 본</strong>은 모든 프레임에서 동작함에도 상대적으로 높은 실행 성능을 보여줍니다.<br>
    </p>
    <br>
    
    <p>
    <strong>지글 본</strong>과 <strong>물리 모디파이어</strong>가 표현하는 대상은 다소 차이가 있습니다.<br>
    하지만 만약 두가지 방식을 대체할 수 있는 경우, <strong>지글 본</strong>을 이용해보는 것이 성능 향상에 도움이 될 것입니다.<br>
    </p>
    <br>
    
    <br>
    <br>
    <!-- 3. 서브 타이틀 -->
    <h3>Mono와 IL2CPP</h3>
    <br>
    
    <p>
    유니티 게임은 C#으로 작성되며, 이 스크립트를 동작시키기 위해 기본적으로 Mono를 이용하여 빌드를 합니다.<br>
    하지만 유니티가 업데이트 되면서 IL2CPP라는 빌드 방식을 지원합니다.<br>
    이 방식은 C# 스크립트를 상대적으로 빠른 C++ 코드로 변경하여 실행하므로, 기존의 Mono 방식의 빌드보다 높은 실행 성능을 가집니다.<br>
    </p>
    <br>
    
    <p>
    빌드하고자 하는 대상 플랫폼이 IL2CPP을 지원한다면, 이 설명이 크게 도움이 될 것입니다.<br>
    IL2CPP에 대한 자세한 설명은 <a href="https://docs.unity3d.com/2021.2/Documentation/Manual/IL2CPP.html">공식 메뉴얼</a>을 참고해보시길 바랍니다.<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1240.jpg"/>
    <br>
    
    <p>
    <strong>(1)</strong> 유니티 에디터의 <strong>Project Settings</strong> 창을 열고 <strong>Player</strong> 메뉴를 선택합니다.<br>
    <strong>(2)</strong> <strong>Scripting Backend</strong>의 옵션을 <strong>Mono</strong>에서 <strong>IL2CPP</strong>로 설정합니다.<br>
    이 상태로 게임을 빌드해서 실행해봅시다.<br>
    (만약 Mono 방식으로 빌드된 경로에 그대로 빌드하면 빌드가 실패될 수 있습니다.)<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1241.jpg"/>
    <br>
    
    <p>
    위의 캐릭터 예제를 <strong>Mono</strong>와 <strong>IL2CPP</strong> 방식으로 각각 빌드하여 테스트한 결과입니다.<br>
    Mono 방식에서 96 FPS를 기록한 결과에 비해, IL2CPP 방식으로 빌드한 경우 50%이상 증가한 148 FPS를 기록하였습니다.<br>
    IL2CPP는 유니티 앱의 CPU 실행 성능을 크게 향상시키는데, AnyPortrait는 거의 대부분 CPU 자원을 이용하여 동작을 하므로 최적화 효과가 매우 크게 나타납니다.<br>
    IL2CPP 빌드 옵션이 여러분의 프로젝트에 적용될 수 있는지 먼저 확인한 이후, 이를 적극적으로 활용해보실 것을 권장합니다.<br>
    </p>
    <br>
    
    <!-- 5. 바닥 네비바 -->
    <br>
    <br>
    <br>
    <br>
    <nav class="navbar fixed-bottom navbar-light bg-light">
        <a class="btn btn-light" role="button" href="../../kr/AdvancedManual/AD_CharacterCostume.html">< 캐릭터의 의상을 교체하기</a>
        <a class="btn btn-light" role="button" href="../../kr/AdvancedManual/AD_AttachEquipments.html">캐릭터에 아이템 장착하기 ></a>
    </nav>
    
    <!-- 페이지 내용 끝! -->

    
    <!-- 종료 -->
    </div>

    <!-- 부트스트랩 -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script type="text/javascript" src="../../js/bootstrap.js"></script>
    <!--------------->

    <!-- 클립보드 스크립트 -->
<!-- NO SCRIPT -->
    <!--------------->

    </body>
</html>
