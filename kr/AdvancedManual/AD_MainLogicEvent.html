<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <!-- 제목 -->
        <title>메인 로직 이벤트</title>
        <!-- 파비콘 -->
        <link rel="shortcut icon" href="../../Images/favicon.ico"/>
        <!-- 부트스트랩 -->
        <link rel="stylesheet" href="../../css/bootstrap.css">
        <!--------------->

    </head>

    <body>
        <p>
            <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark">
            <!--로고 : AnyPortrait 홈페이지로 가야한다. (언어별)-->
            <a class="navbar-brand" href="https://rainyrizzle.com/ko/anyportrait-ko/">
                <img src="../../Images/AP_Logo.png" width="150" height="30" class="d-inline-block align-top" alt="">
            </a>

            <!--메뉴들 : 현재 페이지의 카테고리에 active 붙인다. (언어별 링크) -->
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarText">
                <ul class="navbar-nav mr-auto">
                <li class="nav-item">
                    <a class="nav-link" href="../../kr/GettingStarted.html">시작하기</a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="../../kr/AdManual.html">메뉴얼</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../kr/Script.html">스크립트</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://rainyrizzle.com/ko/ap-video-tutorials-ko/">동영상</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://rainyrizzle.com/ko/forum-ko/">게시판</a>
                </li>

                </ul>

                <!-- 언어 변경. 현재 페이지의 주소에서 언어 주소만 변경한다. (해당 언어에 active) -->
                <div class="btn-group mr-2" role="group" aria-label="Basic example">
                    <a role="button" class="btn btn-secondary" href="../../en/AdvancedManual/AD_MainLogicEvent.html">EN</a>
                    <a role="button" class="btn btn-secondary active" href="../../kr/AdvancedManual/AD_MainLogicEvent.html">KR</a>
                    <a role="button" class="btn btn-secondary" href="../../jp/AdvancedManual/AD_MainLogicEvent.html">JP</a>
                </div>

                <!-- 여백 -->
                <p></p>

                <!-- 검색버튼 -->
                <form class="form-inline">
                    <a class="btn btn-light" role="button" href="../../kr/Search.html">검색</a>
                </form>
            </div>
        </nav>
    </p>

    <!-- 실제 바디 부분 -->
    <div class="container">
    <br>
    <br>
    <!-- 여기에 내용을 적어주세요 -->

    <!-- 여기서부터 페이지 내용이 작성됩니다. -->
    <!-- 1. 페이지 진입 경로 -->
    <p><a href="https://rainyrizzle.com/ko/anyportrait-ko/"><span class="text-dark">AnyPortrait</span></a> > <a href="../../kr/AdManual.html"><span class="text-dark">메뉴얼</span></a> > 메인 로직 이벤트</p>
    
    <!-- 2. 페이지 메인 타이틀 -->
    <h1 class="display-5">메인 로직 이벤트</h1>
    <br>
    
    <!-- 4. 버전 설명 -->
    <h4><span class="badge badge-secondary">1.4.8</span></h4>
    
    <p>
    유니티 엔진은 업데이트와 렌더링이 정해진 순서로 처리됩니다.<br>
    MonoBehaviour 스크립트의 이벤트들이 각각의 단계를 의미합니다.<br>
    AnyPortrait는 유니티에 내장된 기능이 아니므로 "애니메이션이 처리되는 순서"에서 정확하게 업데이트되지는 않지만, 최대한 비슷한 시점에서 업데이트되도록 개발되었습니다.<br>
    (참고 : <a href="https://docs.unity3d.com/kr/2022.3/Manual/ExecutionOrder.html" target="_sub">유니티 엔진의 이벤트 실행 순서</a>)<br>
    </p>
    <br>
    
    <p>
    하지만 사용자가 작성하는 스크립트 또는 다른 에셋들의 특성에 따라서는 AnyPortrait의 업데이트 시점을 변경할 필요도 있을 것입니다.<br>
    AnyPortrait v1.4.8에서 추가된 <strong>Main Logic Event</strong> 옵션을 이용하여 애니메이션과 메시가 갱신되는 시점을 변경할 수 있습니다.<br>
    </p>
    <br>
    
    <br>
    <br>
    <!-- 3. 서브 타이틀 -->
    <h3>메인 로직이 호출되는 이벤트 설정</h3>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1944.jpg"/>
    <br>
    
    <p>
    <strong>(1)</strong> <strong>Bake 다이얼로그</strong>를 엽니다.<br>
    <strong>(2)</strong> <strong>Setting</strong> 탭을 선택합니다.<br>
    <strong>(3)</strong> <strong>Main Logic Event</strong>의 값을 변경하여 메인 로직이 업데이트되는 이벤트를 설정할 수 있습니다.<br>
    </p>
    <br>
    
    <p>
    옵션의 값은 각각 다음과 같습니다.<br>
    - <strong>LateUpdate</strong> : MonoBehaviour의 "<strong>LateUpdate</strong>" 이벤트에서 메인 로직이 실행됩니다. 기본값입니다.<br>
    - <strong>Update</strong> : MonoBehaviour의 "<strong>Update</strong>" 이벤트에서 메인 로직이 실행됩니다.<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1945.jpg"/>
    <br>
    
    <p>
    이 옵션은 <strong>Inspector</strong>에서도 변경할 수 있습니다.<br>
    <strong>(1)</strong> 유니티 씬에서 AnyPortrait 캐릭터를 선택합니다.<br>
    <strong>(2)</strong> 기본 설정 탭을 선택합니다.<br>
    <strong>(3)</strong> <strong>Main Logic Event</strong> 옵션을 설정할 수 있습니다.<br>
    </p>
    <br>
    
    <br>
    <br>
    <!-- 3. 서브 타이틀 -->
    <h3>메인 로직 호출 시점에 대해</h3>
    <br>
    
    <p>
    메인 로직이 언제 호출되는지는 민감한 이슈일 수도, 또는 그렇지 않을 수도 있습니다.<br>
    게임의 각각의 모듈이 느슨한 관계를 가지고 동작한다면 이 옵션은 크게 중요하지 않을 수 있습니다.<br>
    하지만 게임의 1프레임 동안 각각의 모듈이 처리되는 순서가 중요한 경우에 스크립트가 호출되는 순서는 매우 중요해집니다.<br>
    예를 들자면, 캐릭터를 따라다니는 카메라의 업데이트 함수는 캐릭터 로직이 처리된 이후에 호출되어야 할 것입니다.<br>
    애니메이션의 경우도 마찬가지입니다.<br>
    만약 업데이트 순서가 정리되지 않은 상태라면, 애니메이션 재생 요청 등이 제대로 처리되지 않을 수 있습니다.<br>
    따라서 일반적인 스크립트의 처리 순서와 애니메이션의 처리 순서는 분명히 일관된 규칙을 가지고 정해져야 합니다.<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1946.jpg"/>
    <br>
    
    <p>
    애니메이션과 관련하여 유니티의 이벤트 호출 순서를 정리한 그림입니다.<br>
    초기화에 해당하는 Awake와 Start를 지나고, <strong>Update</strong> 이벤트가 호출됩니다.<br>
    그리고 이어서 <strong>애니메이션</strong>이 업데이트됩니다.<br>
    마지막으로 <strong>LateUpdate</strong>가 호출된 후 <strong>렌더링</strong>이 되면 하나의 사이클이 완성됩니다.<br>
    스크립트들의 업데이트와 애니메이션의 처리 단계가 분리되어있기 때문에 오류없이 동작할 수 있는 것입니다.<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1947.jpg"/>
    <br>
    
    <p>
    AnyPortrait는 유니티 내장 기능이 아니기 때문에, 해당 처리 방식을 그대로 이용할 수는 없습니다.<br>
    하지만 최대한 유니티의 애니메이션 처리 순서와 유사하게 동작하도록 위와 같이 메인 로직이 실행되도록 개발을 한 것입니다.<br>
    실제로 AnyPortrait의 메인 로직은 기본적으로 "<strong>LateUpdate</strong>"에서 처리됩니다.<br>
    사용자들이 주로 <strong>Update</strong>에 로직을 작성하기 때문에 이것은 유니티의 처리 순서와 꽤 비슷합니다.<br>
    다만 위 그림에서 보듯이, <strong>LateUpdate</strong> 내에서 다른 스크립트들과의 오류가 발생할 가능성을 가진다는 점은 이 방식의 한계입니다.<br>
    (실행 순서에 의한 문제와 해결 방법은 <a href="../../kr/AdvancedManual/AD_ExecutionOrderProblem.html">관련 페이지</a>에서 확인해보세요.)<br>
    </p>
    <br>
    
    <p>
    이 기본 구조는 대체로 잘 작동하지만, 스크립트 실행 순서를 정교하게 설계하여 개발하는 분들에게는 조금 더 유연한 옵션이 제공될 필요가 있을 것입니다.<br>
    </p>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1948.jpg"/>
    <br>
    
    <p>
    <strong>Main Logic Event</strong> 옵션의 값을 "<strong>Update</strong>"로 변경했을 때의 호출 순서입니다.<br>
    AnyPortrait의 메인 로직이 다른 스크립트와 유사하게 <strong>Update</strong>에서 처리됩니다.<br>
    이 방식을 이용하면 <strong>LateUpdate</strong>에서 더 복잡한 처리들을 조금 더 쉽게 구현할 수 있을 것입니다.<br>
    애니메이션 이벤트 콜백을 빠른 타이밍에 받을 수 있는 것도 장점입니다.<br>
    </p>
    <br>
    
    <p>
    하지만 <strong>Update</strong> 내에서 다른 스크립트와 호출 순서에 따른 문제를 더 많이 발생할 가능성이 높습니다.<br>
    최소한, "애니메이션 재생 요청"을 하는 스크립트는 AnyPortrait 메인 로직보다는 무조건 먼저 실행되어야 합니다.<br>
    따라서 이 방식을 이용한다면 스크립트 실행 순서를 아래의 설명을 꼭 확인해야합니다.<br>
    </p>
    <br>
    
    <br>
    <br>
    <!-- 3. 서브 타이틀 -->
    <h3>Update 이벤트에서 메인 로직이 실행되도록 설정하는 경우</h3>
    <br>
    
    <!-- 8. 이미지 (가운데 정렬) -->
    <br>
    <img class="img-fluid rounded-sm mx-auto d-block" style="max-width:80%;" src="../../Images/Advanced/AdManual_1949.jpg"/>
    <br>
    
    <p>
    <strong>(1)</strong> <strong>Main Logic Event</strong>의 값을 <strong>Update</strong>로 변경합니다.<br>
    <strong>(2)</strong> <strong>Project Settings</strong>을 엽니다.<br>
    <strong>(3)</strong> <strong>Script Execution Order</strong> 메뉴를 선택합니다.<br>
    <strong>(4)</strong> <strong>AnyPortrait.apPortrait</strong>가 <strong>Default Time</strong>보다 나중에 호출되도록 설정합니다. 실행되는 순서가 중요한 다른 스크립트나 에셋들이 있다면 잘 고려하여 실행 순서를 설정하셔야 합니다.<br>
    </p>
    <br>
    
    <!-- 5. 바닥 네비바 -->
    <br>
    <br>
    <br>
    <br>
    <nav class="navbar fixed-bottom navbar-light bg-light">
        <a class="btn btn-light" role="button" href="../../kr/AdvancedManual/AD_RootMotion.html">< 루트 모션</a>
        <a class="btn btn-light" role="button" href="../../kr/AdvancedManual/AD_LinearSpace.html">Linear 색상 공간 ></a>
    </nav>
    
    <!-- 페이지 내용 끝! -->

    
    <!-- 종료 -->
    </div>

    <!-- 부트스트랩 -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script type="text/javascript" src="../../js/bootstrap.js"></script>
    <!--------------->

    <!-- 클립보드 스크립트 -->
<!-- NO SCRIPT -->
    <!--------------->

    </body>
</html>
